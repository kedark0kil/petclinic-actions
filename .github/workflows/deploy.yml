name: deploy to cluster

on:
  push:
    branches:
      - sonar
    paths: .github/workflows/deploy.yml

Jobs:
  deploy:
    name: deploy app
    runs-on: ubuntu-latest
    steps:
    #- uses: actions/checkout@v2
    #- name: Start minikube
    #  uses: medyagh/setup-minikube@master
    #- name: Try the cluster !
    #  run: kubectl get pods -A
    #- name: Build image
    #  run: |
    #      export SHELL=/bin/bash
    #      eval $(minikube -p minikube docker-env)
    #      docker build -f ./Dockerfile -t devopshint/node-app:latest .
    #      echo -n "verifying images:"
    #      docker images  
    - name: minikube deployment
      run: 
      - kubectl apply -f deployment/app-deployment.yaml
      - kubectl apply -f deployment/app-service.yaml